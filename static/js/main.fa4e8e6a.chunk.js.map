{"version":3,"sources":["components/DropZone.jsx","components/Editor.jsx","App.js","reportWebVitals.js","index.js","components/Editor.module.scss","components/DropZone.module.scss"],"names":["DropZone","onUpload","onDrop","files","accept","minSize","maxSize","maxFiles","getRootProps","getInputProps","className","styles","dropZone","type","dropIcon","Editor","image","useState","canvas","setCanvas","clipPath","setClipPath","cropHelper","setCropHelper","imageElement","setImageElement","useEffect","_canvas","fabric","Canvas","width","height","backgroundColor","_clipPath","Rect","_cropHelper","id","fill","stroke","strokeWidth","selectable","add","controlsAboveOverlay","on","e","target","scaleY","scaleX","watchForMoving","boundaries","getBoundingRect","set","left","top","_img","Image","lockSkewingY","lockRotation","_imgSize","centerObject","tips","canvasHolder","onDoubleClick","activeObj","getActiveObject","newActive","discardActiveObject","setActiveObject","requestRenderAll","onClick","dataURL","toDataURL","format","link","document","createElement","download","href","body","appendChild","click","removeChild","exportBtn","views","App","view","setView","setImage","file","url","URL","createObjectURL","img","src","onload","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","getElementById","module","exports"],"mappings":"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","file":"static/js/main.fa4e8e6a.chunk.js","sourcesContent":["import Dropzone from \"react-dropzone\";\n\nimport styles from \"./DropZone.module.scss\";\n\n/**\n * DropZone Component\n * Responsibilities:\n *   - pass to onUpload prop uploaded file\n */\nconst DropZone = ({ onUpload }) => {\n  return (\n    <Dropzone\n      onDrop={(files) => onUpload(files[0])}\n      accept=\"image/*\"\n      minSize={1024}\n      maxSize={3072000}\n      maxFiles={1}\n    >\n      {({ getRootProps, getInputProps }) => {\n        return (\n          <div className={styles.dropZone} {...getRootProps()}>\n            <input type=\"file\" {...getInputProps()} />\n            <div className={styles.dropIcon}>üìÅ</div>\n            <h2>Please drop your image here </h2>\n          </div>\n        );\n      }}\n    </Dropzone>\n  );\n};\n\nexport default DropZone;\n","import { useEffect, useState } from \"react\";\nimport { fabric } from \"fabric\";\n\nimport styles from \"./Editor.module.scss\";\n\nconst CANVAS_WIDTH = 1000;\nconst CANVAS_HEIGHT = 600;\nconst CANVAS_BG = \"white\";\n\n/**\n * Editor Component\n * Responsibilities:\n *   - receive IMG element as argument\n *   - handle crop / image resize\n *   - export result\n */\nconst Editor = ({ image }) => {\n  const [canvas, setCanvas] = useState(null); // fabric.js instance\n  const [clipPath, setClipPath] = useState(null); // fabric.clipPath\n  const [cropHelper, setCropHelper] = useState(null); // `visible` to user crop helper\n  const [imageElement, setImageElement] = useState(null); // image tag\n\n  const exportPNG = () => {\n    const boundaries = cropHelper.getBoundingRect();\n    const dataURL = canvas.toDataURL({\n      width: boundaries.width,\n      height: boundaries.height,\n      left: boundaries.left,\n      top: boundaries.top,\n      format: \"png\",\n    });\n    const link = document.createElement(\"a\");\n    link.download = \"image.png\";\n    link.href = dataURL;\n    document.body.appendChild(link);\n    link.click();\n    document.body.removeChild(link);\n  };\n\n  const handleDblClick = () => {\n    const activeObj = canvas.getActiveObject();\n    if (!activeObj) return;\n\n    const newActive =\n      activeObj.id === \"crop-helper\" ? imageElement : cropHelper;\n    canvas.discardActiveObject();\n    canvas.setActiveObject(newActive);\n\n    canvas.requestRenderAll();\n  };\n\n  // Effects\n\n  // Bootstrap fabric and set all React component's states\n  useEffect(() => {\n    const _canvas = new fabric.Canvas(\"canvas\", {\n      width: CANVAS_WIDTH,\n      height: CANVAS_HEIGHT,\n      backgroundColor: CANVAS_BG,\n    });\n\n    const _clipPath = new fabric.Rect();\n    const _cropHelper = new fabric.Rect({\n      id: \"crop-helper\",\n      fill: \"rgba(0,0,0,0)\",\n      stroke: \"rgba(0,0,0,.2)\",\n      strokeWidth: 1,\n      selectable: false,\n    });\n\n    _canvas.add(_cropHelper);\n    setCanvas(_canvas);\n    setClipPath(_clipPath);\n    setCropHelper(_cropHelper);\n\n    _canvas.clipPath = _clipPath;\n    _canvas.controlsAboveOverlay = true;\n\n    // scale element preserving aspect ratio\n    _canvas.on(\"object:scaling\", (e) => {\n      if (e.target.id === \"img\") {\n        e.target.scaleY = e.target.scaleX;\n      }\n    });\n\n    // track movements of crop helper to set proper clip path\n    const watchForMoving = (e) => {\n      const boundaries = e.target.getBoundingRect();\n\n      if (e.target.id === \"crop-helper\") {\n        _clipPath.set({\n          width: boundaries.width,\n          height: boundaries.height,\n          left: boundaries.left,\n          top: boundaries.top,\n        });\n      }\n    };\n\n    _canvas.on(\"object:moving\", watchForMoving);\n    _canvas.on(\"object:scaling\", watchForMoving);\n  }, []);\n\n  // Watch for `image` prop updates, when passed, add it to canvas and center\n  useEffect(() => {\n    if (image === null || canvas === null) return;\n\n    const _img = new fabric.Image(image, {\n      id: \"img\",\n      lockSkewingY: true,\n      lockRotation: true,\n    });\n    const _imgSize = { width: _img.width, height: _img.height };\n\n    clipPath.set(_imgSize);\n    cropHelper.set(_imgSize);\n\n    canvas.add(_img);\n    canvas.centerObject(_img);\n    canvas.centerObject(clipPath);\n    canvas.centerObject(cropHelper);\n    setImageElement(_img);\n  }, [image, canvas, clipPath, cropHelper]);\n\n  return (\n    <>\n      <ul className={styles.tips}>\n        <li>Drag - to move image inside crop area</li>\n        <li>DoubleClick - to change crop area</li>\n      </ul>\n      <div\n        id=\"canvas-holder\"\n        className={styles.canvasHolder}\n        onDoubleClick={handleDblClick}\n      >\n        <canvas id=\"canvas\"></canvas>\n      </div>\n      <button onClick={exportPNG} className={styles.exportBtn}>\n        export as png\n      </button>\n    </>\n  );\n};\n\nexport default Editor;\n","import { useState } from \"react\";\nimport DropZone from \"./components/DropZone\";\nimport Editor from \"./components/Editor\";\n\nimport \"./App.css\";\n\nconst views = {\n  editor: \"editor\",\n  upload: \"upload\",\n};\n\nfunction App() {\n  const [view, setView] = useState(views.upload);\n  const [image, setImage] = useState(null);\n\n  // receive file\n  // create image element\n  // open editor tab\n  const handleUpload = (file) => {\n    const url = URL.createObjectURL(file);\n    const img = new Image();\n    img.src = url;\n    img.onload = () => setImage(img);\n    setView(\"editor\");\n  };\n\n  return (\n    <div className=\"App\">\n      {view === views.upload ? (\n        <DropZone onUpload={handleUpload} />\n      ) : (\n        <Editor image={image} />\n      )}\n    </div>\n  );\n}\n\nexport default App;\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"tips\":\"Editor_tips__2MY9q\",\"canvasHolder\":\"Editor_canvasHolder__1EAVo\",\"exportBtn\":\"Editor_exportBtn__htYV0\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"dropZone\":\"DropZone_dropZone__Nhuy6\",\"dropIcon\":\"DropZone_dropIcon__2MXoI\"};"],"sourceRoot":""}